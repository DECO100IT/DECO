<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aplikasi Laporan Kerja</title>

<!-- PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{
  font-family:Arial, sans-serif;
  background:#f2f4f7;
  margin:0;
}

.container{
  max-width:1100px;
  margin:30px auto;
  background:#fff;
  padding:20px;
  border-radius:8px;
}

.hidden{display:none}

h2{margin-top:0}

input,textarea,button{
  padding:8px;
  border:1px solid #ccc;
  border-radius:4px;
  width:100%;
}

button{
  cursor:pointer;
  border:none;
}

.blue{background:#2563eb;color:#fff}
.gray{background:#6b7280;color:#fff}
.green{background:#16a34a;color:#fff}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}

th,td{
  border:1px solid #ddd;
  padding:8px;
  text-align:left;
}

th{background:#f3f4f6}

.no-print{}

/* ===== FILTER RESPONSIVE ===== */
.filter-grid{
  display:grid;
  grid-template-columns:1fr 1fr 2fr auto auto;
  gap:10px;
  align-items:end;
}

@media(max-width:900px){
  .filter-grid{
    grid-template-columns:1fr 1fr 1fr;
  }
}

@media(max-width:600px){
  .filter-grid{
    grid-template-columns:1fr;
  }
}

@media print{
  .no-print{display:none}
}
</style>
</head>

<body>

<div class="container" id="loginBox">
  <h2>üîê Login Aplikasi</h2>
  <input id="user" placeholder="Username">
  <input id="pass" type="password" placeholder="Password" style="margin-top:8px">
  <button class="blue" style="margin-top:10px" onclick="login()">Login</button>
  <p id="loginMsg" style="color:red"></p>
</div>

<!-- USER -->
<div class="container hidden" id="userBox">
  <h2>üìù Laporan Kerja User</h2>

  <label>Tanggal</label>
  <input type="date" id="uTanggal">

  <label>Nama</label>
  <input id="uNama">

  <label>Divisi</label>
  <input id="uDivisi">

  <label>Lokasi</label>
  <input id="uLokasi">

  <label>Deskripsi</label>
  <textarea id="uDesk"></textarea>

  <button class="green" style="margin-top:10px" onclick="simpan()">Simpan</button>
  <button class="gray" style="margin-top:10px" onclick="logout()">Logout</button>
</div>

<!-- ADMIN -->
<div class="container hidden" id="adminBox">
  <h2>üìä Dashboard Admin</h2>

  <div class="filter-grid no-print">
    <div>
      <label>Dari</label>
      <input type="date" id="from">
    </div>
    <div>
      <label>Sampai</label>
      <input type="date" id="to">
    </div>
    <div>
      <label>Cari (Nama / Lokasi)</label>
      <input id="search">
    </div>
    <button class="blue" onclick="filter()">Filter</button>
    <button class="gray" onclick="reset()">Reset</button>
  </div>

  <table id="tabel">
    <thead>
      <tr>
        <th>Tanggal</th>
        <th>Nama</th>
        <th>Divisi</th>
        <th>Lokasi</th>
        <th>Deskripsi</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button class="blue no-print" style="margin-top:15px" onclick="exportPDF()">‚¨á Export PDF</button>
  <button class="gray no-print" style="margin-top:10px" onclick="logout()">Logout</button>
</div>

<script>
let data = []

function login(){
  let u=user.value,p=pass.value
  if(u=="ADMIN" && p=="Master99"){
    loginBox.classList.add("hidden")
    adminBox.classList.remove("hidden")
  }else if(p=="user123"){
    loginBox.classList.add("hidden")
    userBox.classList.remove("hidden")
  }else{
    loginMsg.innerText="Login gagal"
  }
}

function logout(){
  location.reload()
}

function simpan(){
  data.push({
    t:uTanggal.value,
    n:uNama.value,
    d:uDivisi.value,
    l:uLokasi.value,
    k:uDesk.value,
    s:"Menunggu"
  })
  alert("Laporan tersimpan")
}

function filter(){
  let tb=document.querySelector("#tabel tbody")
  tb.innerHTML=""
  let f=from.value,t=to.value,s=search.value.toLowerCase()

  data.filter(x=>{
    return (!f||x.t>=f)&&(!t||x.t<=t)&&
           (!s||x.n.toLowerCase().includes(s)||x.l.toLowerCase().includes(s))
  }).forEach(x=>{
    tb.innerHTML+=`<tr>
      <td>${x.t}</td><td>${x.n}</td><td>${x.d}</td>
      <td>${x.l}</td><td>${x.k}</td><td>${x.s}</td>
    </tr>`
  })
}

function reset(){
  from.value=to.value=search.value=""
  filter()
}

function exportPDF(){
  const opt={
    margin:0.5,
    filename:'Laporan_Kerja_IT.pdf',
    html2canvas:{scale:2},
    jsPDF:{orientation:'landscape'}
  }
  html2pdf().set(opt).from(adminBox).save()
}
</script>

</body>
</html>
